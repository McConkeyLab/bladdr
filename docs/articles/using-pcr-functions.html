<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>using-pcr-functions • bladdr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="using-pcr-functions">
<meta property="og:description" content="bladdr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bladdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/using-pcr-functions.html">using-pcr-functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="using-pcr-functions_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>using-pcr-functions</h1>
            
      
      
      <div class="hidden name"><code>using-pcr-functions.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>PCR data appear to be simple to work with at the outset - QuantStudio can output barcharts, and it even readily outputs the data in tabular formats. However, some tasks, like omitting a particular measurement, no longer make the results valid. One must remember to omit it in QuantStudio, recalculate the values, then plot the results - or risk having an inaccurate plot!</p>
<p>Additionally, the plots output by QuantStudio are fairly ugly and inflexible. Outputting them is tedious, as is rearranging columns.</p>
<p>In this vignette, I’ll perform a routine analysis on a rather untidy dataset using the <code>pcr_*</code> suite of functions. The <code>pcr_*</code> suite of functions seek to make life a little easier and a lot more reproducible by allowing many of the previously QuantStudio specific tasks to be done in R.</p>
</div>
<div id="reading-in-data" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-in-data" class="anchor"></a>Reading in Data</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">bladdr</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></code></pre></div>
<p>We have a particular advantage because although the data are untidy, they are untidy in a very specific way. Reading in data is as simple as running <code>pcr_tidy</code>, which is given a path to the pcr .xls(x) file. If no path is given, an interactive file explorer window will appear for the user to choose the file.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcr_tidy.html">pcr_tidy</a></span><span class="op">(</span><span class="st">"../inst/extdata/untidy-pcr-example-2.xlsx"</span><span class="op">)</span>
<span class="co">#&gt; New names:</span>
<span class="co">#&gt; * `` -&gt; ...3</span>
<span class="co">#&gt; * `` -&gt; ...4</span>
<span class="co">#&gt; * `` -&gt; ...5</span>
<span class="co">#&gt; * `` -&gt; ...6</span>
<span class="co">#&gt; * `` -&gt; ...7</span>
<span class="co">#&gt; * ...</span>
<span class="co">#&gt; Warning in mask$eval_all_mutate(quo): NAs introduced by coercion</span>
<span class="va">dat</span>
<span class="co">#&gt; # A tibble: 159 × 40</span>
<span class="co">#&gt;    well  well_position omit  sample_name target_name task    reporter quencher</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   </span>
<span class="co">#&gt;  1 2     A2            FALSE UC3 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt;  2 3     A3            FALSE UC3 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt;  3 4     A4            FALSE UC3 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt;  4 5     A5            FALSE UC3 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt;  5 6     A6            FALSE UC3 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt;  6 7     A7            FALSE T24 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt;  7 8     A8            FALSE T24 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt;  8 9     A9            FALSE T24 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt;  9 10    A10           FALSE T24 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; 10 11    A11           FALSE T24 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; # … with 149 more rows, and 32 more variables: quantity &lt;dbl&gt;,</span>
<span class="co">#&gt; #   quantity_mean &lt;dbl&gt;, quantity_sd &lt;dbl&gt;, rq &lt;dbl&gt;, rq_min &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rq_max &lt;dbl&gt;, ct &lt;dbl&gt;, ct_mean &lt;dbl&gt;, ct_sd &lt;dbl&gt;, delta_ct &lt;chr&gt;,</span>
<span class="co">#&gt; #   delta_ct_mean &lt;chr&gt;, delta_ct_sd &lt;chr&gt;, delta_ct_se &lt;chr&gt;,</span>
<span class="co">#&gt; #   delta_delta_ct &lt;chr&gt;, automatic_ct_threshold &lt;chr&gt;, ct_threshold &lt;dbl&gt;,</span>
<span class="co">#&gt; #   automatic_baseline &lt;chr&gt;, baseline_start &lt;dbl&gt;, baseline_end &lt;dbl&gt;,</span>
<span class="co">#&gt; #   comments &lt;chr&gt;, expfail &lt;chr&gt;, highsd &lt;chr&gt;, noamp &lt;chr&gt;, …</span></code></pre></div>
<p>The typical format of PCR data is woefully non-rectangular. <code>pcr_tidy</code> fixes this by skipping to the good bits, but also pulling out useful metadata supplied in the header and footer of the dataset - like the last few columns:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">plate_type</span><span class="op">:</span><span class="va">ref_samp</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 159 × 2</span>
<span class="co">#&gt;    plate_type     ref_samp  </span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;     </span>
<span class="co">#&gt;  1 384-Well Block RT112 Drug</span>
<span class="co">#&gt;  2 384-Well Block RT112 Drug</span>
<span class="co">#&gt;  3 384-Well Block RT112 Drug</span>
<span class="co">#&gt;  4 384-Well Block RT112 Drug</span>
<span class="co">#&gt;  5 384-Well Block RT112 Drug</span>
<span class="co">#&gt;  6 384-Well Block RT112 Drug</span>
<span class="co">#&gt;  7 384-Well Block RT112 Drug</span>
<span class="co">#&gt;  8 384-Well Block RT112 Drug</span>
<span class="co">#&gt;  9 384-Well Block RT112 Drug</span>
<span class="co">#&gt; 10 384-Well Block RT112 Drug</span>
<span class="co">#&gt; # … with 149 more rows</span></code></pre></div>
</div>
<div id="plate-plotting-with-pcr_plate_view" class="section level1">
<h1 class="hasAnchor">
<a href="#plate-plotting-with-pcr_plate_view" class="anchor"></a>Plate Plotting with <code>pcr_plate_view</code>
</h1>
<p><code>pcr_tidy</code> also adds two features derived from the <code>well_position</code> feature into two separate features - <code>well_row</code> and <code>well_col</code>. This makes downstream plotting particularly easy. A built in function can do this automatically for us:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plate_view.html">pcr_plate_view</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt; Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =</span>
<span class="co">#&gt; "none")` instead.</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/plot_plate_target-1.png" width="100%"></p>
<p>This high level overview lets us see there’s something curious going on with A1. Additionally, some wells at the bottom - likely non-targeting controls - only have two instead of three wells ascribed to them.</p>
<p>What about the <em>sample</em> layout?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plate_view.html">pcr_plate_view</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">sample_name</span><span class="op">)</span>
<span class="co">#&gt; Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =</span>
<span class="co">#&gt; "none")` instead.</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/plot_plate_sample-1.png" width="100%"></p>
<p>We can also look at CT:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plate_view.html">pcr_plate_view</a></span><span class="op">(</span><span class="va">dat</span>, fill <span class="op">=</span> <span class="va">ct</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =</span>
<span class="co">#&gt; "none")` instead.</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/plot_plate_ct-1.png" width="100%"></p>
<p>Looks like some didn’t amplify at all. You might consider looking at it with <code>rq</code> but…</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plate_view.html">pcr_plate_view</a></span><span class="op">(</span><span class="va">dat</span>, fill <span class="op">=</span> <span class="va">rq</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =</span>
<span class="co">#&gt; "none")` instead.</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/plot_plate_rq-1.png" width="100%"></p>
<p>Immediately we see a loss of information: Not only are the scales between cell lines wildly different, but some of the targets aren’t even there! What’s going on?</p>
<p>If we remember back, our reference sample was RT112, which does not appear to express one of the targets at all. Therefore a quantity relative to 0 doesn’t make any sense!</p>
</div>
<div id="expression-plotting-with-pcr_plot" class="section level1">
<h1 class="hasAnchor">
<a href="#expression-plotting-with-pcr_plot" class="anchor"></a>Expression Plotting with <code>pcr_plot</code>
</h1>
<p>We can naively plot all of the data at once using <code>pcr_plot</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 24 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>We notice the differences between cell lines, but the large dynamic range makes it difficult to look at differences between conditions. We can split the data up by cell line and then recalculate rqs individually.</p>
</div>
<div id="rescaling-data-with-pcr_rq" class="section level1">
<h1 class="hasAnchor">
<a href="#rescaling-data-with-pcr_rq" class="anchor"></a>Rescaling Data with <code>pcr_rq</code>
</h1>
<p>First, we need to extract the cell line from the sample name. Additionally, I don’t like how it says “Zeb1” and “Zeb2” instead of “ZEB1” and “ZEB2” (the capitalization leads one to believe we are measuring the protein Zeb1 rather than the transcript that encodes it, ZEB1). I’ll change that here.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cell_line <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">sample_name</span>, <span class="st">"^.*(?=[:space:])"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>target_name <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">target_name</span>, <span class="st">"Zeb"</span>, <span class="st">"ZEB"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As an example, let’s look at UC14:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uc14</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cell_line</span> <span class="op">==</span> <span class="st">"UC14"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/pcr_rq.html">pcr_rq</a></span><span class="op">(</span><span class="st">"UC14 PBS"</span><span class="op">)</span>

<span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">uc14</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<p>I personally prefer it when the control is on the left and the experimental conditions are on the right - let’s flip them. While we’re at it, let’s get rid of the legend - it doesn’t tell us any extra information and is just taking up space.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uc14</span> <span class="op">&lt;-</span> <span class="va">uc14</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">sample_name</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UC14 PBS"</span>, <span class="st">"UC14 Drug"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">uc14</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>The same kind of reorganization can be done with <code>target_names</code> as well - if you wanted to put the control target (here PPIA) at the end.</p>
</div>
<div id="ommiting-a-case" class="section level1">
<h1 class="hasAnchor">
<a href="#ommiting-a-case" class="anchor"></a>Ommiting a case</h1>
<p>Suppose you have reason to believe that one of your colleagues (or perhaps you yourself) spit into your C22 well (the spit was very accurate). If we naively remove it, this is what we get:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">naive</span> <span class="op">&lt;-</span> <span class="va">uc14</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">well_position</span> <span class="op">!=</span> <span class="st">"C24"</span><span class="op">)</span>

<span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">naive</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<p>Umm…it doesn’t look any different. And that’s what we should expect: the plotting function doesn’t do any calculations: <strong>It only plots the values already stored within it.</strong> To get updated values, we need to use <code>pcr_rq</code> again:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">wise</span> <span class="op">&lt;-</span> <span class="va">uc14</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">well_position</span> <span class="op">!=</span> <span class="st">"C24"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/pcr_rq.html">pcr_rq</a></span><span class="op">(</span><span class="st">"UC14 PBS"</span><span class="op">)</span>

<span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">wise</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="using-pcr-functions_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>There we go! A nice updated chart.</p>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>the <code>pcr_*</code> suite of functions are simple, flexible, and pipeable helpers for those working with PCR data.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kai Aragaki, Bridget McGuire, Mingxiao Feng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
